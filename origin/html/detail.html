<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>商品详情页</title>
    <meta name="description" content="品优购JD.COM-专业的综合网上购物商城,销售家电、数码通讯、电脑、家居百货、服装服饰、母婴、图书、食品等数万个品牌优质商品.便捷、诚信的服务，为您提供愉悦的网上购物体验!" />
    <meta name="Keywords" content="网上购物,网上商城,手机,笔记本,电脑,MP3,CD,VCD,DV,相机,数码,配件,手表,存储卡,品优购" />
    <!-- 引入facicon.ico网页图标 -->
    <link rel="shortcut icon" href="../resource/img/favicon.ico" type="image/x-icon" />
    <!-- 引入css 初始化的css 文件 -->
    <link rel="stylesheet" href="../css/base.css">
    <!-- 引入公共样式的css 文件 -->
    <link rel="stylesheet" href="../css/common.css">
    <!-- 引入详情页面的css文件 -->
    <link rel="stylesheet" href="../css/detail.css">
</head>

<body>
    <!-- 顶部快捷导航start -->
    <div class="shortcut">
        <div class="w">
            <div class="fl">
                <ul>
                    <li> <i class="icomoon"></i>广东</li>

                </ul>
            </div>
            <div class="fr">
                <ul>
                    <li>
                        <a href="./login.html">你好,请登录</a>
                        <a href="./register.html" class="style-red">免费注册</a>
                    </li>
                    <li class="spacer"></li>
                    <li><a href="./car.html">我的购物车</a></li>
                    <li class="spacer"></li>
                    <li>
                        <a href="./index.html">我的京东</a>
                        <i class="icomoon"></i>
                    </li>
                    <li class="spacer"></li>
                    <li><a href="#">京东会员</a></li>
                    <li class="spacer"></li>
                    <li><a href="#" class="style-red">企业采购</a><i class="icomoon"></i></li>
                    <li class="spacer"></li>
                    <li><a href="#">客户服务</a> <i class="icomoon"></i></li>
                    <li class="spacer"></li>
                    <li><a href="#">网站导航</a> <i class="icomoon"></i></li>
                    <li class="spacer"></li>
                    <li><a href="#">手机京东</a> </li>

                </ul>
            </div>
        </div>
    </div>
    <!-- 顶部快捷导航end  -->
    <!-- header制作 -->
    <div class="header ">
        <div class="w">
            <!-- logo -->
            <div class="logo">
                <h1>
                    <a href="index.html" title="京东">京东</a>
                </h1>
            </div>
            <h2 style="position: absolute;left: 177px;top: 70px; font-size: 25px; ">商品详情</h2>
            <!-- search -->
            <div class="search" style="left: 706px;">
                <input style="width: 300px; " type="text" class="text" placeholder="蓝月亮洗衣液">
                <button class="searchBtn"><i class="icomoon"></i></button>
            </div>

            <div class="code">
                <img src="../resource/img/code.png">
            </div>

        </div>

    </div>
    <!-- header 结束 -->

    <!-- 详情页内容部分	 -->
    <div class="de_container w">
        <!-- 面包屑导航 -->
        <div class="crumb_wrap">
            <a>返回上一层</a> 〉
            <!-- <a href="#">手机   </a> 〉 <a href="#">Apple苹果   </a> 〉 <a href="#">iphone 6S Plus系类</a> -->
        </div>
        <!-- 产品介绍模块 -->
        <div class="product_intro clearfix">
            <!-- 预览区域 -->
            <div id="left-content" class="preview_wrap fl">
                <!-- <div class="preview_img">
                    <img src="../resource/upload/s3.png" alt="">
                </div>

                <div  class="preview_list">
                    <a href="#" class="arrow_prev"></a>
                    <a href="#" class="arrow_next"></a>
                    <ul class="list_item">
                        <li>
                            <img src="../resource/upload/pre.jpg" alt="">
                        </li>
                        <li class="current">
                            <img src="../resource/upload/pre.jpg" alt="">
                        </li>
                        <li>
                            <img src="../resource/upload/pre.jpg" alt="">
                        </li>
                        <li>
                            <img src="../resource/upload/pre.jpg" alt="">
                        </li>
                        <li>
                            <img src="../resource/upload/pre.jpg" alt="">
                        </li>
                    </ul>
                </div> -->
            </div>
            <!-- 产品详细信息 -->
            <div id="right-content" class="itemInfo_wrap fr">
                <!-- <div class="sku_name">
                    Apple iPhone 6s（A1700）64G玫瑰金色 移动通信电信4G手机
                </div>
                <div class="news">
                    推荐选择下方[移动优惠购],手机套餐齐搞定,不用换号,每月还有花费返
                </div>
                <div class="summary">
                    <dl class="summary_price">
                        <dt>价格</dt>
                        <dd>
                            <i class="price">￥5299.00 </i>

                            <a href="#">降价通知</a>

                            <div class="remark">累计评价612188</div>

                        </dd>
                    </dl>
                    <dl class="summary_promotion">
                        <dt>促销</dt>
                        <dd>
                            <em>加购价</em> 满999.00另加20.00元，或满1999.00另加30.00元，或满2999.00另加40.00元，即可在购物车换 购热销商品 详情 》

                        </dd>
                    </dl>
                    <dl class="summary_support">
                        <dt>支持</dt>
                        <dd>以旧换新，闲置手机回收 4G套餐超值抢 礼品购</dd>
                    </dl>
                    <dl class="choose_color">
                        <dt>选择颜色</dt>
                        <dd>
                            <a href="javascript:;" class="current">玫瑰金</a>
                            <a href="javascript:;">金色</a>
                            <a href="javascript:;">白色</a>
                            <a href="javascript:;">土豪色</a>
                        </dd>
                    </dl>
                    <dl class="choose_version">
                        <dt>选择版本</dt>
                        <dd>
                            <a href="javascript:;" class="current">公开版</a>
                            <a href="javascript:;">移动4G</a>
                        </dd>
                    </dl>
                    <dl class="choose_type">
                        <dt>购买方式</dt>
                        <dd>
                            <a href="javascript:;" class="current">官方标配</a>
                            <a href="javascript:;">移动优惠购</a>
                            <a href="javascript:;">电信优惠购</a>
                        </dd>
                    </dl>
                    <div class="choose_btns">
                        <div class="choose_amount">
                            <input type="text" value="1">
                            <a href="javascript:;" class="add">+</a>
                            <a href="javascript:;" class="reduce">-</a>
                        </div>
                        <a href="#" class="addcar">加入购物车</a>
                    </div>
                </div> -->
            </div>
        </div>


        <!-- 产品细节模块 product_detail	 -->
        <div class="product_detail clearfix">
            <!-- aside -->
            <div class="aside fl">
                <div class="tab_list">
                    <ul>
                        <li class="first_tab ">相关分类</li>
                        <li class="second_tab current">推荐品牌</li>
                    </ul>
                </div>
                <div class="tab_con">

                    <ul>
                        <li>
                            <img src="../resource/upload/aside_img.jpg" alt="">
                            <h5>华为 HUAWEI P20 Pro 全面屏徕卡</h5>
                            <div class="aside_price">¥1229</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>
                        <li>
                            <img src="../resource/upload/third1.jpg" alt="">
                            <h5>超级好看的儿童书籍便宜实惠</h5>
                            <div class="aside_price">¥19</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>
                        <li>
                            <img src="../resource/upload/third2.jpg" alt="">
                            <h5>无敌军舰旗舰电脑超级显卡</h5>
                            <div class="aside_price">¥32219</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>
                        <li>
                            <img src="../resource/upload/third3.jpg" alt="">
                            <h5>华为 HUAWEI P20 Pro 全面屏徕卡</h5>
                            <div class="aside_price">¥19</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>
                        <li>
                            <img src="../resource/upload/second1.jpg" alt="">
                            <h5>超级好看的儿童书籍便宜实惠</h5>
                            <div class="aside_price">¥19</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>
                        <li>
                            <img src="../resource/upload/second2.jpg" alt="">
                            <h5>无敌军舰旗舰电脑超级显卡</h5>
                            <div class="aside_price">¥32219</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>
                        <li>
                            <img src="../resource/upload/second3.jpg" alt="">
                            <h5>华为 HUAWEI P20 Pro 全面屏徕卡</h5>
                            <div class="aside_price">¥19</div>
                            <a href="#" class="as_addcar">加入购物车</a>
                        </li>



                    </ul>
                </div>
            </div>
            <!-- detail -->
            <div class="detail fr">
                <div class="detail_tab_list">
                    <ul>
                        <li id="haha" class="current">商品介绍</li>
                        <li>规格与包装</li>
                        <li>售后保障</li>
                        <li>商品评价（50000）</li>
                        <li>手机社区</li>
                    </ul>
                </div>
                <div id="detail_item" class="detail_tab_con">
                    <!-- <div id="detail_item" class="item">
                        <ul class="item_info">
                            <li>分辨率：1920*1080(FHD)</li>
                            <li>后置摄像头：1200万像素</li>
                            <li>前置摄像头：500万像素</li>
                            <li>核 数：其他</li>
                            <li>频 率：以官网信息为准</li>
                            <li>品牌： Apple ♥关注</li>
                            <li>商品名称：APPLEiPhone 6s Plus</li>
                            <li>商品编号：1861098</li>
                            <li>商品毛重：0.51kg</li>
                            <li>商品产地：中国大陆</li>
                            <li>热点：指纹识别，Apple Pay，金属机身，拍照神器</li>
                            <li>系统：苹果（IOS）</li>
                            <li>像素：1000-1600万</li>
                            <li>机身内存：64GB</li>
                        </ul>
                        <p>
                            <a href="#" class="more">查看更多参数</a>
                        </p>
                        <img src="../resource/upload/detail_img1.jpg" alt="">
                        <img src="../resource/upload/detail_img2.jpg" alt="">
                        <img src="../resource/upload/detail_img3.jpg" alt="">
                    </div> -->
                    <!-- 
					<div class="item">规格与包装</div>
					<div class="item">售后保障</div> 
					-->
                </div>
            </div>
        </div>

    </div>
    <!-- 详情页内容部分	 -->

    <!-- footer start -->
    <div class="footer">
        <div class="w">
            <!-- mod_service -->
            <div class="mod_service">
                <ul>
                    <li>
                        <i class="mod-service-icon mod_service_duo"></i>
                        <div class="mod_service_tit">
                            <h3>品类齐全,轻松购物</h3>
                        </div>
                    </li>
                    <li>
                        <i class="mod-service-icon mod_service_kuai"></i>
                        <div class="mod_service_tit">
                            <h3>多仓直发,急速配送</h3>
                        </div>
                    </li>
                    <li>
                        <i class="mod-service-icon mod_service_hao"></i>
                        <div class="mod_service_tit">
                            <h3>正品行货,精致服务</h3>
                        </div>
                    </li>
                    <li>
                        <i class="mod-service-icon mod_service_sheng"></i>
                        <div class="mod_service_tit">
                            <h3>天天低价,畅选无忧</h3>

                        </div>
                    </li>
                </ul>
            </div>
            <!-- mod_help -->
            <div class="mod_help">
                <dl class="mod_help_item">
                    <dt>购物指南</dt>
                    <dd> <a href="#">购物流程 </a></dd>
                    <dd> <a href="#">会员介绍 </a></dd>
                    <dd> <a href="#">生活旅行 </a></dd>
                    <dd> <a href="#">常见问题 </a></dd>
                    <dd> <a href="#">大家电 </a></dd>
                    <dd> <a href="#">联系客服 </a></dd>
                </dl>
                <dl class="mod_help_item">
                    <dt>配送方式</dt>
                    <dd> <a href="#">上门自提 </a></dd>
                    <dd> <a href="#">211限时送 </a></dd>
                    <dd> <a href="#">配送服务查询 </a></dd>
                    <dd> <a href="#">配送费收费标准 </a></dd>
                    <dd> <a href="#">海外配送</a></dd>
                </dl>
                <dl class="mod_help_item">
                    <dt>支付方式</dt>
                    <dd> <a href="#">货到付款 </a></dd>
                    <dd> <a href="#">在线支付 </a></dd>
                    <dd> <a href="#">分期付款 </a></dd>
                    <dd> <a href="#">公司转账 </a></dd>

                </dl>
                <dl class="mod_help_item">
                    <dt>售后服务</dt>
                    <dd> <a href="#">售后政策 </a></dd>
                    <dd> <a href="#">价格保护 </a></dd>
                    <dd> <a href="#">退款说明 </a></dd>
                    <dd> <a href="#">常见问题 </a></dd>
                    <dd> <a href="#">返修/退换货 </a></dd>
                    <dd> <a href="#">取消订单</a></dd>
                </dl>
                <dl class="mod_help_item">
                    <dt>特色服务</dt>
                    <dd> <a href="#">夺宝岛 </a></dd>
                    <dd> <a href="#">DIY装机 </a></dd>
                    <dd> <a href="#">延保服务</a></dd>
                    <dd> <a href="#">京东E卡 </a></dd>
                    <dd> <a href="#">京东通信 </a></dd>
                    <dd> <a href="#">鲸鱼座智能</a></dd>
                </dl>
                <dl class="mod_help_item mod_help_app">
                    <dt>京东自营覆盖区县</dt>
                    <dd>

                        <sapn>京东已向全国2661个区县提供自营配送服务，支持货到付款、POS机刷卡和售后上门服务。</sapn>
                    </dd>
                </dl>
            </div>

            <!-- mod_copyright  -->
            <div class="mod_copyright">
                <p class="mod_copyright_links">
                    关于我们 | 联系我们 | 联系客服 | 合作招商 | 商家帮助| 营销中心 | 手机京东 | 友情链接 | 销售联盟 | 京东社区 | 风险监测 | 隐私政策 | 京东公益 | English Site | Media & IR
                </p>
                <p class="mod_copyright_info">
                    京公网安备110000200080号京Cp证070359号|互联网药品信息服务资格证编号(京)经营性20140008新出发京零字第大120007号
                </p>
                <p class="mod_copyright_info">
                    联网出版许可证编号新出网证(字150号出版物经营许可证|网络文化经营许可证京网文[201412148-348号违法和不良信息举报电话:4006561155
                </p>
                <p class="mod_copyright_info">
                    Copyright &copyright; C2004-2020京东Dcom版权所有消费者维权热线:4006067733经营证照|(京网械平台备字(2018)第00003
                </p>
                <p class="mod_copyright_info">
                    京东旗下网站:京东钱包 | 京东智联
                </p>
                <p class="mod_copyright_link">
                    <img src="../resource/img/footerLink.png" alt="">
                </p>

            </div>
        </div>
    </div>
    <!-- footer end -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/offset.js"></script>
    <script>
        $(function() {

            var getID = function(key) {
                    var querystring = location.search.slice(1);

                    var arr = querystring.split("&");

                    for (var i = 0; i < arr.length; i++) {
                        var subArr = arr[i].split("=");
                        if (subArr[0] == key) {
                            return subArr[1];
                        }
                    }
                }
                //点击该商品详情的id
            var id = getID("id");
            var $leftContent = $("#left-content");
            var $rightContent = $("#right-content");
            var $detail_item = $("#detail_item")
            var $goback = $(".crumb_wrap a");

            $goback.click(function() {
                history.go(-1);
            })

            //根据该id查询数据库的信息并且渲染信息
            $.get("/jingdongphp/goodsInfoById.php", {
                "id": id
            }, function(data) {
                if (!data.error) {
                    $leftContent.html(`
                <div class="preview_img"  >
                    <img src=${data.data.goods_big_logo}  alt="">
                    <div id="mask" class="mask"></div>
                    <div class="big" style="   background: url(${data.data.goods_big_logo}) no-repeat 0 0;"  alt=""></div>
                </div>
              
                <div  class="preview_list">
                    <a href="#" class="arrow_prev"></a>
                    <a href="#" class="arrow_next"></a>
                    <ul class="list_item">
                        <li>
                            <img src=${data.data.goods_small_logo} alt="">
                        </li>
                        <li class="current">
                            <img src=${data.data.goods_small_logo} alt="">
                        </li>
                        <li>
                            <img src=${data.data.goods_small_logo} alt="">
                        </li>
                        <li>
                            <img src=${data.data.goods_small_logo} alt="">
                        </li>
                        <li>
                            <img src=${data.data.goods_small_logo} alt="">
                        </li>
                    </ul>
                </div>
                `);

                    $rightContent.html(`
                <div class="sku_name">
                    ${data.data.goods_name}
                </div>
                <div class="news">
                    ${data.data.goods_name}
                </div>
                <div class="summary">
                    <dl class="summary_price">
                        <dt>价格</dt>
                        <dd>
                            <i class="price">${data.data.goods_price} </i>

                            <a href="#">降价通知</a>

                            <div class="remark">累计评价612188</div>

                        </dd>
                    </dl>
                    <dl class="summary_promotion">
                        <dt>促销</dt>
                        <dd>
                            <em>加购价</em> 满999.00另加20.00元，或满1999.00另加30.00元，或满2999.00另加40.00元，即可在购物车换 购热销商品 详情 》

                        </dd>
                    </dl>
                    <dl class="summary_support">
                        <dt>支持</dt>
                        <dd>以旧换新，闲置手机回收 4G套餐超值抢 礼品购</dd>
                    </dl>
                    <dl class="choose_color">
                        <dt>选择尺码</dt>
                        <dd id="selectSize">
                            <a  class="current">S</a>
                            <a >M</a>
                            <a >L</a>
                            <a >XL</a>
                        </dd>
                    </dl>
                    <dl class="choose_version">
                        <dt>库存</dt>
                        <dd>
                           
                            <a href="javascript:;" class="style-red">${data.data.goods_number}</a>
                        </dd>
                    </dl>
                    <dl class="choose_type">
                        <dt >购买方式</dt>
                        <dd id="payWay">
                            <a  class="current">货到付款</a>
                            <a >线上支付</a>
                            <a >分期支付</a>
                        </dd>
                    </dl>
                    <div class="choose_btns">
                        
                        <a href="#" class="addcar">加入购物车</a>
                    </div>
                </div>
                `)
                    $detail_item.html(`${data.data.goods_introduce}`);

                    var $selectSize = $("#selectSize a");
                    var $payWay = $("#payWay a");
                    var $listItem = $(".list_item li")

                    //------选择添加红色边框
                    $selectSize.click(function() {
                        $(this).addClass("current").siblings().removeClass("current");
                    })
                    $payWay.click(function() {
                        $(this).addClass("current").siblings().removeClass("current");
                    })
                    $listItem.click(function() {
                        $(this).addClass("current").siblings().removeClass("current");
                    })




                    //--------------------------放大镜-------------

                    $(function() {
                        // 获取元素
                        var small = document.querySelector(".preview_img");
                        var mask = document.getElementById("mask");
                        var big = document.querySelector(".big");

                        console.log(small.clientWidth, mask.clientWidth)
                            // 获取small在页面中的位置
                        var obj = offset(small);

                        // 鼠标进入small区域 
                        small.onmouseenter = function(e) {
                            // 显示两个盒子
                            big.style.display = "block";
                            mask.style.display = "block";
                        }
                        small.onmousemove = function(e) {
                            // 定义比例
                            var r = (small.clientWidth - mask.clientWidth) / 400;
                            // 获取鼠标在页面中的位置
                            var pageX = e.pageX;
                            var pageY = e.pageY;

                            var x = pageX - obj.left - mask.clientWidth / 2;
                            var y = pageY - obj.top - mask.clientHeight / 2;
                            if (x < 0) {
                                x = 0;
                            } else if (x > small.clientWidth - mask.offsetWidth) {
                                x = small.clientWidth - mask.offsetWidth;
                            }
                            if (y < 0) {
                                y = 0;
                            } else if (y > small.clientHeight - mask.offsetHeight) {
                                y = small.clientHeight - mask.offsetHeight;
                            }
                            // 设置镜片的定位值
                            mask.style.left = x + "px";
                            mask.style.top = y + "px";

                            big.style.backgroundPositionX = -x / r + 'px';
                            big.style.backgroundPositionY = -y / r + 'px';
                        }
                        small.onmouseleave = function(e) {
                            // 隐藏两个盒子
                            big.style.display = "none";
                            mask.style.display = "none";
                        }

                        function stop(e) {
                            e.preventDefault();
                        }
                        document.onselectstart = stop;

                    })


                    //-----------------------------加入购物车------------------------
                    var allgoodsarr = [];
                    $.post("/jingdongphp/sumgoods.php", {}, function(data) {
                        if (!data.error) {
                            allgoodsarr = data.data;
                        } else { //弹出错误信息
                            console.log("没有拿到数据");
                        }
                    }, "json");

                    $(".choose_btns").click(function(e) {
                        if (e.target.className == "addcar") {
                            var goodID = id;
                            var goodsInfo = allgoodsarr.find(function(value) {
                                return value.goods_id == goodID;
                            })
                            console.log(goodID);

                            //刚开始拿到的是以前的记录开始累加，或者是新数组
                            var shopCartRecordstring = localStorage.getItem("shppingcart") || "[]";


                            //把新的字符串转为数组
                            var shopCartRecordarr = JSON.parse(shopCartRecordstring);

                            var existRecord = shopCartRecordarr.find(function(value) {
                                return value.goods_id == goodID;
                            })
                            if (existRecord) {
                                existRecord.count++;
                            } else {
                                goodsInfo.count = 1;
                                shopCartRecordarr.push(goodsInfo);
                            }
                            console.log(shopCartRecordarr.length);
                            localStorage.setItem("shppingcart", JSON.stringify(shopCartRecordarr));
                            location.href = "./car.html";
                        }

                    })



                }
            }, "json")



        })
    </script>



</body>

</html>